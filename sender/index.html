<!DOCTYPE html>
<html>
	<head>
		<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
<meta content="utf-8" http-equiv="encoding">
		</head>
<body>

<p>Add commmand:</p>

<body onload="onload();">
    <input type="text" name="enter" class="enter" value="" id="cmdText"/>
    <input type="button" value="Add to queue" onclick="addToQueue();"/>
</body>

<p>Queue:</p>
<p id="queue"></p>

<script type="text/javascript">
    var cmdText;

    var myVar = setInterval(myTimer, 1000);
    //var index = 0;
    function myTimer() {
        //document.getElementById("queue").innerHTML = index.toString();
        //index = index + 1; 

        var xhr = new XMLHttpRequest();
        xhr.onreadystatechange = function() { 
            console.log('xhr.responseText = ', xhr.responseText)
            if (xhr.readyState == 4) {
                if (xhr.status == 200) {
                    var response = xhr.responseText;
                    document.getElementById("queue").innerHTML = response;
                } else {
                    document.getElementById("queue").innerHTML = xhr.status + ': ' + xhr.statusText;
                }
            }
        };
        xhr.open("GET", '/status', true);
        xhr.send(null);
        
    }

    function onload() { 
        cmdText = document.getElementById('cmdText');
    }

    function addToQueue() {
	if (cmdText.value)
	{
        	//alert(cmdText.value);
		var currentLocation = window.location;
		//alert(currentLocation);

        	//var xhr = new XMLHttpRequest();
        	//var params = 'cmdText=' + encodeURIComponent(cmdText.value);
        	//xhr.open("GET", '/submit?' + params, true);
        	//xhr.send();

		var formData = new FormData();

        	formData.append("username", "Groucho");
        	formData.append("accountnum", 123456);

        	//formData.append("userfile", fileInputElement.files[0]);

        	// JavaScript Blob object
        	//var content = cmdText.value;//'<a id="a"><b id="b">hey!</b></a>';
        	//var blob = new Blob([content], { type: "text/xml"});
        	//formData.append("cmdText", blob);

        	formData.append("cmdText", cmdText.value);

        	var request = new XMLHttpRequest();
		request.open("POST", "/send");
        	request.send(formData);
	}
	else
	{
		alert('Command should not be empty');
	}

    }

</script>

</body>
</html>

